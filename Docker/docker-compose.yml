version: '3.4'

services:
  authserver.web:
    build:
      context: .
      dockerfile: ../AuthServer.Web/Dockerfile
    container_name: AuthServer
    environment:
      - ASPNETCORE_ENVIRONMENT=Production
      - ASPNETCORE_URLS=https://+:443#;http://+:80
      - ASPNETCORE_Kestrel__Certificates__Default__Path=/app/cert/cert.pfx
      - ASPNETCORE_Kestrel__Certificates__Default__Password=33731801
    ports:
      - "80:80"
      - "4000:443"
    volumes:
#     - /Users/igor/.microsoft/usersecrets:/root/.microsoft/usersecrets:ro
#     - /Users/igor/.aspnet/https:/root/.aspnet/https:ro
      - ./certificates/:/app/cert/
      - ./application/:/app/

  sql-server:
    container_name: sql-server
    image: mcr.microsoft.com/azure-sql-edge
    ports:
      - "1433:1433"
    environment:
      - "ACCEPT_EULA=1"
      - "MSSQL_SA_PASSWORD=SU2orange!"
    volumes:
      - "./mssql/data/:/var/opt/mssql/data/"
      - "./mssql/log/:/var/opt/mssql/log/"
      - "./mssql/secrets/:/var/opt/mssql/secrets/"