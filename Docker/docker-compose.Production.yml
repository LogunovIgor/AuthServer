version: '3.4'

services:
  authserver-app:
    build:
      context: .
      dockerfile: ../AuthServer.Web/Dockerfile
    container_name: AuthServer-Application
    environment:
      - ASPNETCORE_ENVIRONMENT=Production
#     - ASPNETCORE_ENVIRONMENT=Development
      - ASPNETCORE_URLS=http://+:80
#     - ASPNETCORE_URLS=http://+:80;https://+:443
#     - ASPNETCORE_Kestrel__Certificates__Default__Path=/app/cert/cert.pfx
#     - ASPNETCORE_Kestrel__Certificates__Default__Password=33731801
    ports:
      - "80:80"
#      - "4000:443"
#    volumes:
#     - ./certificates/:/app/cert
#     - /var/run/docker.sock:/var/run/docker.sock
    #command: sh -c "dotnet dev-certs https -ep ./certificate.pfx --trust"

  authserver-sql:
    container_name: AuthServer-Sql
    image: mcr.microsoft.com/azure-sql-edge
    ports:
      - "1433:1433"
    environment:
      - "ACCEPT_EULA=1"
      - "MSSQL_SA_PASSWORD=SU2orange!"
    volumes:
      - "./mssql/data/:/var/opt/mssql/data/"
      - "./mssql/log/:/var/opt/mssql/log/"
      - "./mssql/secrets/:/var/opt/mssql/secrets/"